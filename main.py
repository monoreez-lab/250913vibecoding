# app.py
# MBTIë³„ ìµœì  ê³µë¶€ë²• ì¶”ì²œ ì›¹ì•± (for Streamlit Cloud)
# ë£¨ë£¨ë¥¼ ìœ„í•´: ì§ê´€ì  UI, ì´ëª¨ì§€ ë“¬ë¿, ì¬ë¯¸ ìš”ì†Œ í¬í•¨!

import streamlit as st
from datetime import datetime
import random
import textwrap

st.set_page_config(
    page_title="MBTI ê³µë¶€ë²• ì²˜ë°©ì „",
    page_icon="ğŸ§ ",
    layout="centered",
    initial_sidebar_state="expanded",
)

# ---------- ìŠ¤íƒ€ì¼ & ì• ë‹ˆë©”ì´ì…˜ ----------
CSS = """
<style>
/* ë°°ê²½ ê·¸ë¼ë°ì´ì…˜ */
.stApp {
  background: radial-gradient(1200px 800px at 10% 10%, #fff7e6 0%, #ffffff 40%) no-repeat,
              linear-gradient(135deg, #f9f7ff 0%, #ffffff 60%) no-repeat;
}
/* ì¹´ë“œ ëŠë‚Œ */
.block-container { padding-top: 2.2rem; }
.card {
  background: white;
  border: 1px solid rgba(0,0,0,.06);
  border-radius: 16px;
  padding: 1.2rem 1.1rem;
  box-shadow: 0 6px 24px rgba(0,0,0,.06);
}
/* ë°˜ì§ ì• ë‹ˆë©”ì´ì…˜ */
@keyframes pop {
  0% { transform: scale(.98); }
  50% { transform: scale(1.02); }
  100% { transform: scale(1.0); }
}
.pop { animation: pop .6s ease-out; }
/* ì¹© */
.chip {
  display: inline-block;
  padding: .25rem .6rem;
  border-radius: 999px;
  background: #f3f4f6;
  margin-right: .35rem;
  margin-bottom: .35rem;
  font-size: .85rem;
}
.small { opacity: .8; font-size: .86rem; }
code { white-space: pre-wrap; }
</style>
"""
st.markdown(CSS, unsafe_allow_html=True)

# ---------- ë°ì´í„° ----------
MBTI_DATA = {
    "INTJ": {
        "name": "INTJ Â· ì „ëµê°€ ğŸ§­",
        "vibe": "êµ¬ì¡°í™”Â·ì¥ê¸° í”ŒëœÂ·ìê¸°ì£¼ë„",
        "strengths": ["ì²´ê³„í™”", "ì¥ê¸°ì „ëµ", "ì§‘ì¤‘ë ¥"],
        "pitfalls": ["ê³¼ë„í•œ ì™„ë²½ì£¼ì˜", "ì‹œì‘ ì§€ì—°(Procrastination)"],
        "strategies": [
            "ğŸ“š **í† í”½ íŠ¸ë¦¬**ë¥¼ ë¯¸ë¦¬ ì„¤ê³„ â†’ í° ì£¼ì œ â–¶ ì¤‘ì£¼ì œ â–¶ ì†Œì£¼ì œë¡œ ìª¼ê°œê¸°",
            "â± **íƒ€ì„ë°•ì‹±(25â€“50ë¶„)** + ëì‹œê°„ ê³ ì •ìœ¼ë¡œ ì™„ë²½ì£¼ì˜ ì œì–´",
            "ğŸ§© â€˜ì´í•´ ë§µ(Concept Map)â€™ìœ¼ë¡œ ê°œë… ê°„ ì—°ê²° ê·¸ë¦¬ê¸°",
            "ğŸ§ª **ëª¨ì˜ê³ ì‚¬ â†’ ì˜¤ë‹µì €ë„**: ì˜¤ë¥˜ ìœ í˜• ë ˆì´ë¸”ë§(ê°œë…/ì‹¤ìˆ˜/ì‹œê°„ê´€ë¦¬)",
        ],
        "tools": ["Notion Database", "Anki Spaced Repetition", "Mermaid/Excalidraw", "Focus To-Do"],
        "buddies": "ENFP(ì•„ì´ë””ì–´ í™•ì¥), ISTJ(ë””í…Œì¼ ê²€ì¦)",
    },
    "INTP": {
        "name": "INTP Â· ì‚¬ìƒ‰ê°€ ğŸ§ª",
        "vibe": "ì›ë¦¬íŒŒÂ·ì¶”ë¡ Â·ê¹Šê²Œ íŒŒê¸°",
        "strengths": ["ê°œë…í™”", "ë¬¸ì œí•´ê²°", "ìœ ì—°í•œ ì‚¬ê³ "],
        "pitfalls": ["ìë£Œ ìˆ˜ì§‘ë§Œ í•˜ë‹¤ ì‹œì‘ ëŠ¦ì¶¤", "ë§ˆê° ì••ë°• ì·¨ì•½"],
        "strategies": [
            "ğŸ¯ **ì§ˆë¬¸ ë¦¬ìŠ¤íŠ¸(ì™œ/ì–´ë–»ê²Œ/ë§Œì•½)**ë¥¼ ë¨¼ì € ì‘ì„±í•˜ê³  í•™ìŠµ ì‹œì‘",
            "ğŸ§  **íŒŒì¸ë§Œ ê¸°ë²•**: 10ì‚´ì—ê²Œ ì„¤ëª…í•˜ë“¯ ìš”ì•½ ê¸°ë¡í•˜ê¸°",
            "ğŸ” **Interleaving**: ì„œë¡œ ë‹¤ë¥¸ ê³¼ëª©/ìœ í˜• ë²ˆê°ˆì•„ í•™ìŠµ",
            "â›³ **ë§ˆê° íŠ¸ë¦¬ì˜¤**: ì†Œë§ˆê°(ì˜¤ëŠ˜)Â·ì¤‘ê°„(ì£¼ë§)Â·ìµœì¢…(ì‹œí—˜ ì „)",
        ],
        "tools": ["Obsidian Zettelkasten", "Anki Cloze", "Jupyter(ì‹¤í—˜)", "Pomofocus"],
        "buddies": "ENTJ(ì¶”ì§„ë ¥), ESFJ(ë£¨í‹´ ì•ˆì •í™”)",
    },
    "ENTJ": {
        "name": "ENTJ Â· ì§€íœ˜ê´€ ğŸ§¨",
        "vibe": "ëª©í‘œì§€í–¥Â·ì‹¤ì Â·ì†ë„",
        "strengths": ["ì¶”ì§„ë ¥", "ê³„íš ì‹¤í–‰", "ì˜ì‚¬ê²°ì •"],
        "pitfalls": ["ê³¼ë¶€í•˜ ê³„íš", "íœ´ì‹ ê²½ì‹œ"],
        "strategies": [
            "ğŸ **OKR**: Objective(1) + KR(3ê°œ ì´í•˜)ë¡œ ì£¼ê°„ ëª©í‘œ ì„¤ì •",
            "ğŸ“ˆ ë§¤ì¼ **ì„±ê³¼ì§€í‘œ(ë¬¸í•­ìˆ˜/í•™ìŠµì‹œê°„/ì •í™•ë„)** ëŒ€ì‹œë³´ë“œí™”",
            "ğŸ‘¥ **ê°€ë¥´ì¹˜ê¸° ìŠ¤í„°ë””(Teach-back)**ë¡œ ë¦¬ë”ì‹­+ì´í•´ë„ ìƒìŠ¹",
            "ğŸŒ¿ **ë¦¬ì»¤ë²„ë¦¬ ë¸”ë¡**: 90ë¶„ ì§‘ì¤‘ í›„ 10â€“15ë¶„ íšŒë³µ ë£¨í‹´",
        ],
        "tools": ["Google Sheets Dashboard", "Notion OKR", "Forest", "Past papers DB"],
        "buddies": "INTP(ê¹Šì´), ISFJ(ë””í…Œì¼Â·ì§€ì†ì„±)",
    },
    "ENTP": {
        "name": "ENTP Â· ë°œëª…ê°€ ğŸ’¡",
        "vibe": "ì•„ì´ë””ì–´Â·í† ë¡ Â·ë³€í™”",
        "strengths": ["ë¸Œë ˆì¸ìŠ¤í† ë°", "ë¬¸ì œ ì¬ì •ì˜", "ì¦‰í¥ì„±"],
        "pitfalls": ["ê¸ˆë°© ì§ˆë¦¼", "ë§ˆë¬´ë¦¬ ì•½í•¨"],
        "strategies": [
            "ğŸ² **ê²Œì„í™”**: í€˜ìŠ¤íŠ¸Â·ê²½í—˜ì¹˜Â·ë³´ìƒ ì‹œìŠ¤í…œìœ¼ë¡œ ê³¼ì œ ìª¼ê°œê¸°",
            "ğŸ¤ **í† ë¡ í˜• ìš”ì•½**: 3ë¶„ ìŠ¤í”¼ì¹˜Â·ë°˜ë°• í¬ì¸íŠ¸ ë§Œë“¤ê¸°",
            "ğŸ§± **ë§ˆê°í˜• ìŠ¤í”„ë¦°íŠ¸(45ë¶„)** + 5ë¶„ ë°ëª¨(ë°°ìš´ ê²ƒ ë°œí‘œ)",
            "ğŸ”— ì•„ì´ë””ì–´ëŠ” **ì¹¸ë°˜(Backlogâ†’Doingâ†’Done)**ìœ¼ë¡œ í˜ë ¤ë³´ë‚´ê¸°",
        ],
        "tools": ["Trello/Asana", "Kahoot/Quizizz", "Voice Recorder ìš”ì•½", "Anki"],
        "buddies": "INFJ(ê¹Šì´Â·ì˜ë¯¸), ESTJ(ì‹¤í–‰Â·ë§ˆê°)",
    },
    "INFJ": {
        "name": "INFJ Â· ì˜¹í˜¸ì ğŸŒ™",
        "vibe": "ì˜ë¯¸Â·ì •ë¦¬Â·ëª°ì…",
        "strengths": ["í†µì°°", "ë©”íƒ€ì¸ì§€", "ì„œì‚¬ì  ì •ë¦¬"],
        "pitfalls": ["ê°ì •ì†Œì§„", "ì™„ë²½ì£¼ì˜ ë…¸íŠ¸"],
        "strategies": [
            "ğŸ§­ **í•µì‹¬ ì§ˆë¬¸ 3ê°œ** ì •í•˜ê³  ëª¨ë“  ìë£Œë¥¼ ê·¸ ì§ˆë¬¸ì— ì—°ê²°",
            "ğŸ§¾ **í•œ í˜ì´ì§€ ìš”ì•½(One-pager)**: ìŠ¤í† ë¦¬Â·ì˜ˆì‹œÂ·ì˜¤ê°œë… ì •ì •",
            "ğŸ¤ **ë™ë£Œ íŠœí„°ë§**: ì˜ë¯¸ ë¶€ì—¬ + ì„¤ëª… ëŠ¥ë ¥ ê°•í™”",
            "ğŸŒ± **ë£¨í‹´ ì•µì»¤**: ê³ ì • ì‹œê°„Â·ê³ ì • ì¥ì†ŒÂ·ê³ ì • ìŒì•…",
        ],
        "tools": ["Notion Template", "GoodNotes/OneNote", "Readwise", "Lofi playlist"],
        "buddies": "ENTP(ê´€ì  í™•ì¥), ISTP(í˜„ì‹¤ ê²€ì¦)",
    },
    "INFP": {
        "name": "INFP Â· ì¤‘ì¬ì ğŸ«§",
        "vibe": "ê°€ì¹˜Â·ì°½ì˜Â·ëª°ì…",
        "strengths": ["ìƒìƒë ¥", "ê¸€ì“°ê¸°", "ëª°ì…"],
        "pitfalls": ["ê¸°ë¶„ ë”°ë¼ ì¶œë ì„", "ìš°ì„ ìˆœìœ„ í˜¼ë€"],
        "strategies": [
            "ğŸ’– **ê°€ì¹˜ ì—°ê²°**: ì˜¤ëŠ˜ ê³µë¶€ê°€ ë‚´ ì¥ê¸° ê°€ì¹˜/í•™ìƒì—ê²Œ ì£¼ëŠ” ì˜í–¥ ì ê¸°",
            "ğŸ€ **3Ã—3 í”Œëœ**: ì˜¤ëŠ˜ 3ê°œ, ì´ë²ˆì£¼ 3ê°œ, ì´ë²ˆë‹¬ 3ê°œ",
            "ğŸ—£ **ì½ì–´-ë§í•´-ì“°ëŠ”** 3ë‹¨ ë£¨í”„ë¡œ ì •ì„œ+ê¸°ì–µ ê²°í•©",
            "ğŸ¯ **ë¯¸ë‹ˆ ë°ë“œë¼ì¸**: 30â€“40ë¶„ ë¸”ë¡ + ìŠ¤í‹°ì»¤ ë³´ìƒ",
        ],
        "tools": ["Notion Kanban", "Day One/Journal", "Speechify/TTS", "Anki"],
        "buddies": "ESTJ(í˜„ì‹¤Â·ë§ˆê°), ENFJ(ë™ê¸° ë¶€ì—¬)",
    },
    "ENFJ": {
        "name": "ENFJ Â· ì„ ë„ì âœ¨",
        "vibe": "í˜‘ì—…Â·í”¼ë“œë°±Â·ì½”ì¹­",
        "strengths": ["ì†Œí†µ", "ë™ê¸°ë¶€ì—¬", "ì¡°ì§í™”"],
        "pitfalls": ["ë‚¨ ëŒë³´ëŠë¼ ìê¸° ê³µë¶€ ë°€ë¦¼"],
        "strategies": [
            "ğŸ‘¥ **ì±…ì„ íŒŒíŠ¸ë„ˆ**: ë§¤ì¼ 5ë¶„ ìƒí˜¸ ì²´í¬ì¸(ëª©í‘œ/ì§„í–‰/ì •ì„œ)",
            "ğŸ§¾ **ì˜ˆìŠµ-ìˆ˜ì—…-ë³µìŠµ** ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ íë¦„ ê³ ì •",
            "ğŸ“£ **í”¼ë“œë°± ë£¨í”„**: ì£¼ 1íšŒ ëª¨ì˜ê°•ì˜ í›„ í”¼ë“œë°± ìˆ˜ì§‘",
            "ğŸ§˜ **ê²½ê³„ ì„¤ì •**: ëŒë´„ ì‹œê°„/í•™ìŠµ ì‹œê°„ ìº˜ë¦°ë”ë¡œ ë¶„ë¦¬",
        ],
        "tools": ["Google Calendar Block", "Notion Checklist", "Loom ëª¨ì˜ê°•ì˜", "Anki"],
        "buddies": "ISTP(í˜„ì‹¤ì„±), INTJ(êµ¬ì¡°í™”)",
    },
    "ENFP": {
        "name": "ENFP Â· í™œí™œëŸ¬ âš¡",
        "vibe": "ì—´ì •Â·ì—°ê²°Â·íƒí—˜",
        "strengths": ["ë°œí™”ë ¥", "ì—°ê²°ì„±", "ì°½ì˜"],
        "pitfalls": ["ì‚°ë§Œ", "ê³¼ë‹¤ ì•½ì†"],
        "strategies": [
            "ğŸ **í…Œë§ˆ ë°ì´**(ì›”:ì´ë¡ , í™”:ë¬¸ì œ, ìˆ˜:ì˜¤ë‹µ, â€¦)ë¡œ ë‹¤ì–‘ì„±+ì¼ê´€ì„±",
            "ğŸ§² **ì§‘ì¤‘ ìì„**: 10ë¶„ ìŠ¤íƒ€í„° ê³¼ì œ(ì œì¼ ì‰¬ìš´ ê²ƒ)ë¡œ ì‹œë™",
            "ğŸ¥ **ìê¸° ì„¤ëª… ì´¬ì˜(2ë¶„)** â†’ ìš”ì•½ ì¹´ë“œ ë§Œë“¤ê¸°",
            "ğŸ§± **ì•½ì† ì œí•œ ê·œì¹™**: ì£¼ë‹¹ í° ì•½ì† 2ê°œê¹Œì§€ë§Œ",
        ],
        "tools": ["Focusmate", "CapCut/Clips", "Quizizz", "TickTick"],
        "buddies": "ISTJ(ì•ˆì •), INTJ(ì „ëµ)",
    },
    "ISTJ": {
        "name": "ISTJ Â· ê´€ë¦¬ì ğŸ“",
        "vibe": "ê·œìœ¨Â·ì •í™•Â·ê¸°ë¡",
        "strengths": ["ê¾¸ì¤€í•¨", "ì •í™•ì„±", "ì²´ê³„ ë¬¸ì„œí™”"],
        "pitfalls": ["ë³€í™” ê±°ë¶€ê°", "ê³¼ë„í•œ ë””í…Œì¼"],
        "strategies": [
            "ğŸ“… **ë£¨í‹´ ìº˜ë¦°ë”ë§**: ë§¤ì¼ ê°™ì€ ì‹œê°„Â·ê°™ì€ ì¥ì†ŒÂ·ê°™ì€ ìˆœì„œ",
            "âœ… **ì²´í¬ë¦¬ìŠ¤íŠ¸ ê¸°ë°˜ í•™ìŠµ íë¦„**(ì˜ˆìŠµâ†’í•™ìŠµâ†’ë³µìŠµâ†’í…ŒìŠ¤íŠ¸)",
            "ğŸ”„ **ê°„ê²©ë°˜ë³µ(SRS)**: ë³µìŠµì¼ ìë™í™”",
            "ğŸ§­ ì£¼ 1íšŒ **ì „ëµ ë¦¬ë·°**ë¡œ ì „ì²´ ë°©í–¥ ì ê²€",
        ],
        "tools": ["Google Calendar", "Notion Templates", "Anki", "Excel/Sheets ë¡œê·¸"],
        "buddies": "ENFP(ìœ ì—°ì„±), ENTJ(ëª©í‘œ ê°€ì†)",
    },
    "ISFJ": {
        "name": "ISFJ Â· ìˆ˜í˜¸ì ğŸ«¶",
        "vibe": "ë°°ë ¤Â·ì„±ì‹¤Â·ì•ˆì •",
        "strengths": ["ì±…ì„ê°", "ê¸°ë¡", "ì„¸ì‹¬í•¨"],
        "pitfalls": ["ìê¸° ìš”êµ¬ í›„ìˆœìœ„", "ê³¼ë¶€ë‹´"],
        "strategies": [
            "ğŸŒ¸ **ë”°ëœ»í•œ ì‹œì‘**: ì‰¬ìš´ ê³¼ì œë¡œ ì„±ê³µê°ë¶€í„°",
            "ğŸ“¦ **íŒ©í‚¤ì§€ ê³µë¶€**: êµì¬/ë…¸íŠ¸/ë¬¸ì œ/ì˜¤ë‹µ í•œ ë¬¶ìŒìœ¼ë¡œ ê´€ë¦¬",
            "ğŸ§‘â€ğŸ¤â€ğŸ§‘ **ì§ ì—°ìŠµ**: ì„¤ëª…Â·í”¼ë“œë°±ìœ¼ë¡œ ê¸°ì–µ ê°•í™”",
            "ğŸŒ¿ **íšŒë³µ ë£¨í‹´**: ìŠ¤íŠ¸ë ˆì¹­Â·í‹°íƒ€ì„ ì˜ˆì•½",
        ],
        "tools": ["GoodNotes", "Notion Pack", "Focus To-Do", "Anki"],
        "buddies": "ENTP(ë°œìƒ), ENFJ(ë™ê¸°)",
    },
    "ISTP": {
        "name": "ISTP Â· ì¥ì¸ ğŸ”§",
        "vibe": "ì‹¤ì „Â·ë¬¸ì œí’€ê¸°Â·íš¨ìœ¨",
        "strengths": ["ë¶„ì„", "ì†ì— ìµíˆê¸°", "ëƒ‰ì •í•¨"],
        "pitfalls": ["ì´ë¡  ê±´ë„ˆë›°ê¸°", "ë£¨í‹´ ë¶ˆì•ˆì •"],
        "strategies": [
            "ğŸ§© **ë¬¸ì œâ†’ì´ë¡  ì—­ì¶”ì **: í‹€ë¦° ë¬¸ì œì—ì„œ ê°œë… ë¶ë§ˆí¬",
            "â² **ìŠ¤í”¼ë“œ ë“œë¦´**: ì œí•œì‹œê°„ ë‚´ í’€ì´ ë£¨í‹´í™”",
            "ğŸ§± **ìµœì†Œ ë£¨í‹´(30ë¶„)**: ë§¤ì¼ ê°™ì€ ì‹œê° ìµœì†Œë¸”ë¡ ìœ ì§€",
            "ğŸ“’ **í…Œí¬ ë¡œê·¸**: í’€ì´ ì „ëµê³¼ ë„êµ¬ ì„¤ì • ê¸°ë¡",
        ],
        "tools": ["Timer/Tabata", "Excel í’€ì´ë¡œê·¸", "Past Papers", "Anki"],
        "buddies": "ENFJ(ì¼ê´€ì„±), INFJ(ê¹Šì´)",
    },
    "ISFP": {
        "name": "ISFP Â· ì˜ˆìˆ ê°€ ğŸ¨",
        "vibe": "ê°ê°Â·ê°ì„±Â·ììœ¨",
        "strengths": ["ë¯¸ì  ê°ìˆ˜ì„±", "ì„¬ì„¸í•¨", "ê³µê°"],
        "pitfalls": ["ë™ê¸° ê¸°ë³µ", "ì‹œê°„ ì¶”ì  ì•½í•¨"],
        "strategies": [
            "ğŸ§ **ë¦¬ì¶”ì–¼ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸** + íƒ€ì„ë©ìŠ¤ ì´¬ì˜ìœ¼ë¡œ ëª°ì… ìœ ë„",
            "ğŸ“· **ë¹„ì£¼ì–¼ ë…¸íŠ¸**: ë„ì‹/ìƒ‰/ì•„ì´ì½˜ìœ¼ë¡œ ìš”ì•½",
            "ğŸ§­ **ê°€ë³ê²Œ ì‹œì‘(10ë¶„)** â†’ ëª°ì…ë˜ë©´ ì—°ì¥",
            "â± **íƒ€ì„íŠ¸ë˜í‚¹**ìœ¼ë¡œ ì‹¤ì œ ê³µë¶€ì‹œê°„ ê°€ì‹œí™”",
        ],
        "tools": ["Notion Gallery", "GoodNotes/Procreate", "Toggl", "Anki"],
        "buddies": "ENTJ(ëª©í‘œ), ESTJ(êµ¬ì¡°)",
    },
    "ESTJ": {
        "name": "ESTJ Â· ì‹¤í–‰ê°€ ğŸ—ï¸",
        "vibe": "ê·œìœ¨Â·ì„±ê³¼Â·ë¦¬ë”ì‹­",
        "strengths": ["ì¼ì •ê´€ë¦¬", "ë§ˆê°", "í‘œì¤€í™”"],
        "pitfalls": ["ìœµí†µì„± ë¶€ì¡±", "ê³¼ë„í•œ ìê¸°ë¹„íŒ"],
        "strategies": [
            "ğŸ“Š **WBS**ë¡œ ë²”ìœ„ ìª¼ê°œê³  ì£¼ê°„ ê°„íŠ¸ì°¨íŠ¸ ìš´ì˜",
            "ğŸ§ª **ì£¼ê¸°ì  ëª¨ì˜ê³ ì‚¬**ë¡œ ê°ê´€ ì§€í‘œ í™•ë³´",
            "ğŸ§˜ **ì™„ë£Œ-ë³´ìƒ í”„ë¡œí† ì½œ**(ì™„ë£Œâ†’ì§§ì€ ì‚°ì±…/ì°¨)",
            "ğŸ§© â€˜ì˜ˆì™¸ì¼â€™ ëŒ€ë¹„ **ë²„í¼ ë¸”ë¡** ì˜ˆì•½",
        ],
        "tools": ["Sheets Gantt", "Notion WBS", "Forest", "Past papers DB"],
        "buddies": "INFP(ì°½ì˜Â·ê· í˜•), ENFP(ë™ê¸°)",
    },
    "ESFJ": {
        "name": "ESFJ Â· ì‚¬êµê°€ ğŸ¤",
        "vibe": "í˜‘ë™Â·ë£¨í‹´Â·ì•ˆì •ê°",
        "strengths": ["í˜‘ë ¥", "ê¾¸ì¤€í•¨", "ì •ë¦¬"],
        "pitfalls": ["ì™¸ë¶€ í‰íŒ ì˜ì¡´", "ìê¸° ì‹œê°„ ë¶€ì¡±"],
        "strategies": [
            "ğŸ‘¥ **ìŠ¤í„°ë”” ì§„í–‰ì ì—­í• **ë¡œ ì±…ì„ê°+ëª°ì…",
            "ğŸ§¾ **ì²´í¬ë¦¬ìŠ¤íŠ¸ ë½**: ëë‚¼ ë•Œê¹Œì§€ ì•± ì ê¸ˆ",
            "ğŸ§˜ **1ì¸ ì§‘ì¤‘ íƒ€ì„**ì„ ìº˜ë¦°ë”ë¡œ ë³´í˜¸",
            "ğŸ§  **í€´ì¦ˆ ë¦¬ë“œ**: ë‹¤ë¥¸ ì‚¬ëŒ í…ŒìŠ¤íŠ¸ ì œì‘",
        ],
        "tools": ["Google Calendar", "StayFocusd/Focus", "Quizlet/Quizizz", "Anki"],
        "buddies": "INTP(ê¹Šì´), ISTP(í˜„ì‹¤)",
    },
    "ESTP": {
        "name": "ESTP Â· ë„ì „ì ğŸï¸",
        "vibe": "ì•¡ì…˜Â·ê²½ìŸÂ·í˜„ì¥ê°",
        "strengths": ["ì‹¤ì „ê°ê°", "ë¹ ë¥¸ ì ì‘", "ë‹´ëŒ€í•¨"],
        "pitfalls": ["ë°˜ë³µí›ˆë ¨ ì§€ë£¨í•¨", "ì¥ê¸° ê³„íš ì•½í•¨"],
        "strategies": [
            "ğŸ **íƒ€ì„ì–´íƒ ì±Œë¦°ì§€**: ê¸°ë¡ ê¹¨ê¸°ì‹ í›ˆë ¨",
            "ğŸ“£ **ìŠ¤ëª° ë² íŒ…**: í•˜ë£¨ ëª©í‘œ ê±¸ê³  ë¯¸ì…˜ ì„±ê³µì‹œ ë³´ìƒ",
            "ğŸ¯ **ë¬¸ì œâ†’ë°”ë¡œ í”¼ë“œë°±**: ìë™ì±„ì /ì¦‰ì‹œ ì˜¤ë‹µ",
            "ğŸ—º **ì£¼ê°„ ë¯¸ì…˜ë³´ë“œ**ë¡œ ë°©í–¥ì„± í™•ë³´",
        ],
        "tools": ["Khan/Past papers", "Quiz apps", "Habitica", "Trello"],
        "buddies": "INFJ(ê¹Šì´), ISFJ(ì•ˆì •)",
    },
    "ESFP": {
        "name": "ESFP Â· ì—”í„°í…Œì´ë„ˆ ğŸ­",
        "vibe": "ì¦ê±°ì›€Â·ì¦‰í¥Â·ê°ê°",
        "strengths": ["ë°œí‘œ", "ì¦‰í¥ì„±", "ê´€ì°°ë ¥"],
        "pitfalls": ["ì§€ì†ì„± ì•½í•¨", "ë”´ì§“ ìœ í˜¹"],
        "strategies": [
            "ğŸ¥ **ì¹´ë©”ë¼ ì• ìš”ì•½**: 1ë¶„ ë¦¬ìº¡ ë¦´ìŠ¤ ì°ê¸°",
            "ğŸ‘¯ **í˜ì–´ í•™ìŠµ**: ë²ˆê°ˆì•„ ë¬¸ì œ ë‚´ê³  ì„¤ëª…",
            "â± **ì§§ê³  ì¦ê²Œ(20â€“30ë¶„)** + ì†Œì…œ ë³´ìƒ",
            "ğŸ§­ **í•™ìŠµ ì²´í¬í¬ì¸íŠ¸**ë¥¼ ê²½í—˜ ì´ë²¤íŠ¸ë¡œ ë¬¶ê¸°",
        ],
        "tools": ["CapCut/Reels", "Quiz apps", "Focusmate", "TickTick"],
        "buddies": "INTJ(êµ¬ì¡°), ISTJ(ì¼ê´€)",
    },
}

MBTI_LIST = list(MBTI_DATA.keys())

MOTIVATIONS = [
    "ì‘ê²Œ ì‹œì‘, í¬ê²Œ ì™„ì„±! âœ¨",
    "ì˜¤ëŠ˜ì˜ 1%ê°€ ì¼ ë…„ ë’¤ 37ë°° ğŸ“ˆ",
    "ì™„ë²½ë³´ë‹¤ ì™„ë£Œ! âœ…",
    "ì§‘ì¤‘ì€ ìŠµê´€, ì„±ê³¼ëŠ” ë³´ë„ˆìŠ¤ ğŸ",
    "ë£¨í‹´ì´ ì¬ëŠ¥ì„ ì´ê¸´ë‹¤ ğŸ’ª",
]

# ---------- ì‚¬ì´ë“œë°” ----------
with st.sidebar:
    st.markdown("## ğŸ§  MBTI ê³µë¶€ë²• ì²˜ë°©ì „")
    st.markdown("ì„¼ìŠ¤ìˆëŠ” ì´ëª¨ì§€ & ê°€ë²¼ìš´ íš¨ê³¼ë¡œ ë™ê¸° UP â¤´ï¸")
    st.divider()
    with st.expander("ğŸ¯ ì‚¬ìš©ë²•", expanded=True):
        st.write(
            "- ìƒë‹¨ì—ì„œ **MBTI**ë¥¼ ê³ ë¥´ë©´ ë§ì¶¤ ì „ëµì„ ë³´ì—¬ì¤˜ìš”.\n"
            "- ìš°ì¸¡ ë²„íŠ¼ìœ¼ë¡œ **ê°œì¸ í”Œëœ**ì„ í•œ ë²ˆì— ë³µì‚¬/ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆì–´ìš”.\n"
            "- ê°€ë²¼ìš´ ğŸˆ / â„ï¸ íš¨ê³¼ë¡œ ì¬ë¯¸ë„ ì±™ê²¼ì–´ìš”!"
        )
    st.caption("Made with â¤ï¸ for íš¨ê³¼ì ì¸ í•™ìŠµ")

# ---------- í—¤ë” ----------
col1, col2 = st.columns([0.8, 0.2])
with col1:
    st.markdown("# MBTI ìœ í˜•ë³„ ê³µë¶€ë²• ì¶”ì²œ ğŸ“šâœ¨")
    st.markdown(f"*{random.choice(MOTIVATIONS)}*")
with col2:
    st.metric("ì˜¤ëŠ˜ ë‚ ì§œ", datetime.now().strftime("%Y-%m-%d"))

# ---------- ì…ë ¥ ìœ„ì ¯ ----------
c1, c2 = st.columns([1, 1])
with c1:
    mbti = st.selectbox(
        "ë‹¹ì‹ ì˜ MBTIë¥¼ ì„ íƒí•˜ì„¸ìš”",
        MBTI_LIST,
        index=MBTI_LIST.index("INTJ") if "INTJ" in MBTI_LIST else 0,
        help="16ê°€ì§€ ì¤‘ì—ì„œ ì„ íƒ!",
    )
with c2:
    fun_effect = st.toggle("ì¬ë¯¸ íš¨ê³¼ ì¼œê¸° ğŸ‰", value=True, help="ğŸˆ/â„ï¸/í† ìŠ¤íŠ¸ ë“± ê°€ë²¼ìš´ íš¨ê³¼")

if fun_effect:
    # ì„ íƒ ì‹œ í•œ ë²ˆë§Œ í’ì„ 
    if "did_balloon" not in st.session_state:
        st.balloons()
        st.session_state["did_balloon"] = True
    else:
        st.toast("ğŸš€ ì˜¤ëŠ˜ë„ í•œ ê±¸ìŒ!", icon="ğŸ”¥")

data = MBTI_DATA.get(mbti)

# ---------- ë³¸ë¬¸ ì¹´ë“œ ----------
st.markdown("### ğŸ’¡ ë§ì¶¤ ì²˜ë°©")
st.markdown('<div class="card pop">', unsafe_allow_html=True)
st.subheader(f"{data['name']}")
st.caption(f"í•™ìŠµ ë¬´ë“œ: {data['vibe']}")

cols = st.columns(3)
with cols[0]:
    st.markdown("**ê°•ì ** ğŸŒŸ")
    st.write(", ".join(data["strengths"]))
with cols[1]:
    st.markdown("**ì£¼ì˜ì ** âš ï¸")
    st.write(", ".join(data["pitfalls"]))
with cols[2]:
    st.markdown("**ì˜ ë§ëŠ” ìŠ¤í„°ë”” ë©”ì´íŠ¸** ğŸ¤")
    st.write(data["buddies"])

st.markdown("**ì¶”ì²œ ì „ëµ**")
for s in data["strategies"]:
    st.markdown(f"- {s}")

st.markdown("**ì¶”ì²œ ë„êµ¬** ğŸ§°")
tool_line = " ".join([f'<span class="chip">{t}</span>' for t in data["tools"]])
st.markdown(tool_line, unsafe_allow_html=True)
st.markdown("</div>", unsafe_allow_html=True)

# ---------- ê°œì¸í™”ëœ í•˜ë£¨ ë£¨í‹´ ìƒì„± ----------
st.markdown("### ğŸ—“ï¸ ì˜¤ëŠ˜ì˜ 90ë¶„ ë£¨í‹´(ì˜ˆì‹œ)")
routine = [
    "â±ï¸ 00â€“05ë¶„ Â· ì›Œë°ì—…: ì˜¤ëŠ˜ ëª©í‘œ í•œ ì¤„ ì“°ê¸°",
    "ğŸ“– 05â€“35ë¶„ Â· í•µì‹¬ ì½˜í…ì¸  í•™ìŠµ(ê°œë…/ê°•ì˜/ì½ê¸°)",
    "ğŸ§  35â€“50ë¶„ Â· ìš”ì•½/ê·¸ë¦¼/ì„¤ëª…(íŒŒì¸ë§Œ/ë¹„ì£¼ì–¼ ë…¸íŠ¸)",
    "ğŸ§© 50â€“75ë¶„ Â· ë¬¸ì œí’€ì´/ì ìš©/í€´ì¦ˆ",
    "ğŸ” 75â€“85ë¶„ Â· ì˜¤ë‹µ/ë§‰íŒ ë¶€ë¶„ ë©”ëª¨",
    "ğŸŒ¿ 85â€“90ë¶„ Â· ì •ë¦¬ & ë‹¤ìŒ ì•¡ì…˜ 1ê°œ í™•ì •",
]
st.markdown('\n'.join([f"- {r}" for r in routine]))

# ---------- ë‚´ë³´ë‚´ê¸° / ë³µì‚¬ ----------
plan_text = textwrap.dedent(f"""
[MBTI ê³µë¶€ë²• ì²˜ë°©ì „]
ìœ í˜•: {mbti} - {data['name']}
ë¬´ë“œ: {data['vibe']}

â–  ê°•ì 
- {', '.join(data['strengths'])}

â–  ì£¼ì˜ì 
- {', '.join(data['pitfalls'])}

â–  ì¶”ì²œ ì „ëµ
- {data['strategies'][0]}
- {data['strategies'][1]}
- {data['strategies'][2]}
- {data['strategies'][3]}

â–  ì¶”ì²œ ë„êµ¬
- {', '.join(data['tools'])}

â–  ì˜¤ëŠ˜ì˜ 90ë¶„ ë£¨í‹´
- {routine[0]}
- {routine[1]}
- {routine[2]}
- {routine[3]}
- {routine[4]}
- {routine[5]}

ë©”ëª¨: ì™„ë²½ë³´ë‹¤ ì™„ë£Œ! ì˜¤ëŠ˜ í•  ì¼ 1ê°œë§Œ í™•ì‹¤íˆ ëë‚´ê¸° âœ…
""").strip()

st.divider()
b1, b2, b3 = st.columns([1, 1, 1])
with b1:
    st.download_button(
        "ğŸ“ í”Œëœ ë‹¤ìš´ë¡œë“œ(.txt)",
        plan_text.encode("utf-8"),
        file_name=f"MBTI_{mbti}_study_plan.txt",
        mime="text/plain",
        help="ì˜¤ëŠ˜ ë°”ë¡œ ì“¸ ìˆ˜ ìˆëŠ” ê°œì¸ í”Œëœ",
    )
with b2:
    if st.button("ğŸ“‹ í´ë¦½ë³´ë“œ ë³µì‚¬(ì½”ë©˜íŠ¸ í¬í•¨)"):
        st.code(plan_text)
        st.toast("ë³µì‚¬ ì¤€ë¹„ ì™„ë£Œ! ìœ„ í…ìŠ¤íŠ¸ë¥¼ âŒ˜/Ctrl+C ëˆ„ë¥´ì„¸ìš”.", icon="ğŸ“")
with b3:
    if fun_effect and st.button("â„ï¸ ìŠ¤ë…¸ìš° ì´í™íŠ¸"):
        st.snow()

# ---------- ì§„í–‰ë„(ì¥ë‚œê° ê²Œì´ì§€) ----------
st.markdown("### â³ ì§‘ì¤‘ ê²Œì´ì§€")
p = st.progress(0, text="ì§‘ì¤‘ ì¤€ë¹„ ì¤‘â€¦")
for i in range(0, 101, 25):
    p.progress(i, text=f"ì§‘ì¤‘ ê²Œì´ì§€ {i}%")
st.caption("Tip: 20ë¶„ë§Œ í•´ë„ ì‹œì‘ì€ ì„±ê³µì´ì—ìš”! ğŸ’ª")

# í‘¸í„°
st.markdown("---")
st.caption("ğŸ”– ì°¸ê³ : ê°œì¸ì°¨ê°€ í½ë‹ˆë‹¤. ë„êµ¬/ì „ëµì€ ë³¸ì¸ì—ê²Œ ë§ê²Œ ê°€ê°í•˜ì„¸ìš”.")
